<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyZDCF &mdash; pyZDCF  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> pyZDCF
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">pyZDCF</a><ul>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#how-to-use">How to use</a></li>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#license">License</a></li>
<li><a class="reference internal" href="#contact">Contact</a></li>
<li><a class="reference internal" href="#citation">Citation</a></li>
<li><a class="reference internal" href="#api-documentation">API documentation</a></li>
<li><a class="reference internal" href="#acknowledgments">Acknowledgments</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">pyZDCF</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>pyZDCF</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pyzdcf">
<h1>pyZDCF<a class="headerlink" href="#pyzdcf" title="Permalink to this headline"></a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline"></a></h2>
<p><strong>pyZDCF</strong> is a Python module that emulates a widely used Fortran
program called ZDCF (Z-transformed Discrete Correlation Function,
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1997ASSL..218..163A/abstract">Alexander 1997</a>).
It is used for robust estimation of cross-correlation function of sparse
and unevenly sampled astronomical time-series. This Python
implementation also introduces sparse matrices in order to significantly
reduce RAM usage when running the code on large time-series (&gt; 3000
points).</p>
<p>pyZDCF is based on the original Fortran code fully developed by
Prof. Tal Alexander from Weizmann Institute of Science, Israel
(see Acknowledgements and References for details and further reading).</p>
</section>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline"></a></h2>
<p>Development of pyZDCF module was motivated by the long and successful usage of
the original ZDCF Fortran code in the analysis of light curves of active galactic
nuclei by our research group (see <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2014AdSpR..54.1414K/abstract">Kovacevic et al. 2014</a>,
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019MNRAS.485.4790S/abstract">Shapovalova et al. 2019</a>,
and reference therein). One of the science cases we investigate is photometric reverberation
mapping in the context of Legacy Survey of Space and Time (LSST) survey strategies (see <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2022AN....34310090J/abstract">Jankov et
al. 2022</a>). However, this module is <strong>general</strong> and is meant to be used for cross-correlation of spectroscopic or photometric light curves, same as the original Fortran version.</p>
<p><strong>Dependencies</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">=</span> <span class="s2">&quot;&gt;=3.8,&lt;3.11&quot;</span>
<span class="n">numpy</span> <span class="o">=</span> <span class="s2">&quot;&gt;=1.16.5,&lt;1.23.0&quot;</span>
<span class="n">pandas</span> <span class="o">=</span> <span class="s2">&quot;^1.3&quot;</span>
<span class="n">scipy</span> <span class="o">=</span> <span class="s2">&quot;^1.7.3&quot;</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="how-to-use">
<h2>How to use<a class="headerlink" href="#how-to-use" title="Permalink to this headline"></a></h2>
<p><strong>Input files</strong></p>
<p>This code requires user-provided plain text files as input. CSV files
are accepted by default, but you can use any other delimited file, as
long as you provide the <code class="docutils literal notranslate"><span class="pre">sep</span></code> keyword argument when calling <code class="docutils literal notranslate"><span class="pre">pyzdcf</span></code>
function. The input light curve file should be in 3 columns: time
(ordered), flux/magnitude and absolute error on flux/magnitude. Make
sure to exclude the header (column names) from the input files.</p>
<p>First few lines of the example input file accepted by default (CSV):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.9594479339474323</span><span class="p">,</span><span class="mf">0.0019188958678948648</span>
<span class="mf">1.0</span><span class="p">,</span><span class="mf">0.9588196871078336</span><span class="p">,</span><span class="mf">0.0019176393742156672</span>
<span class="mf">2.0</span><span class="p">,</span><span class="mf">0.9637198686651904</span><span class="p">,</span><span class="mf">0.0019274397373303808</span>
<span class="mf">3.0</span><span class="p">,</span><span class="mf">0.9622807967282166</span><span class="p">,</span><span class="mf">0.0019245615934564328</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> pyZDCF is tested only with input files having whole numbers (integers) for time column. If you have decimal numbers (e.g., you have a light curve with several measurments in the same night expressed as fractions of a day instead of minutes), just convert them into a time format with integer values (e.g., minutes instead of days). On the other hand, you could round the values from the same day (e.g. 5.6 –&gt; 5, 5.8 –&gt; 5, etc.) and the algorithm will take in the information and average the flux for that day.</p>
<p><strong>Input parameters</strong></p>
<p>If you use interactive mode (<code class="docutils literal notranslate"><span class="pre">intr</span> <span class="pre">=</span> <span class="pre">True</span></code>), then pyZDCF will ask you to
enter all input parametars interactively, similarly to original ZDCF interface.
There is also a manual mode (<code class="docutils literal notranslate"><span class="pre">intr</span> <span class="pre">=</span> <span class="pre">False</span></code>) where you can provide input
parameters using a dictionary and passing it to <code class="docutils literal notranslate"><span class="pre">parameters</span></code> keyword argument.</p>
<p>Available input parameters (keys in the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> dictionary) are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">autocf</span></code> - if <code class="docutils literal notranslate"><span class="pre">True</span></code>, perform auto-correlation, otherwise do the cross-correlation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prefix</span></code> - provide a name for the output .dcf file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uniform_sampling</span></code> - if <code class="docutils literal notranslate"><span class="pre">True</span></code>, set flag to perform uniform sampling of the light curve.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">omit_zero_lags</span></code> - if True, omit zero lag points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minpts</span></code> - minimal number of points per bin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_MC</span></code> - number of Monte Carlo simulations for error estimation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lc1_name</span></code> - Name of the first light curve file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lc2_name</span></code> - Name of the second light curve file (required only if we do cross-correlation)</p></li>
</ul>
<p>For more information on the correct syntax, see “Running the code” subsection and the “API Documentation” section.</p>
<p><strong>Output</strong></p>
<p>The return value of the <code class="docutils literal notranslate"><span class="pre">pyzdcf</span></code> function is a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> object
displaying the results in 7 columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+---+-------+-------------+-------------+--------------+-------------+-------------+------+</span>
<span class="o">|</span>   <span class="o">|</span>   <span class="n">tau</span> <span class="o">|</span>   <span class="o">-</span><span class="n">sig</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span> <span class="o">|</span>   <span class="o">+</span><span class="n">sig</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span> <span class="o">|</span>          <span class="n">dcf</span> <span class="o">|</span>   <span class="o">-</span><span class="n">err</span><span class="p">(</span><span class="n">dcf</span><span class="p">)</span> <span class="o">|</span>   <span class="o">+</span><span class="n">err</span><span class="p">(</span><span class="n">dcf</span><span class="p">)</span> <span class="o">|</span> <span class="c1">#bin |</span>
<span class="o">|---+-------+-------------+-------------+--------------+-------------+-------------+------|</span>
<span class="o">|</span> <span class="mi">0</span> <span class="o">|</span>  <span class="o">-</span><span class="mi">991</span> <span class="o">|</span>           <span class="mi">4</span> <span class="o">|</span>           <span class="mi">0</span> <span class="o">|</span>  <span class="mf">0.13598</span>     <span class="o">|</span>  <span class="mf">0.361559</span>   <span class="o">|</span>  <span class="mf">0.342224</span>   <span class="o">|</span>   <span class="mi">10</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span> <span class="o">|</span>  <span class="o">-</span><span class="mi">988</span> <span class="o">|</span>           <span class="mi">2</span> <span class="o">|</span>           <span class="mi">0</span> <span class="o">|</span> <span class="o">-</span><span class="mf">0.217733</span>    <span class="o">|</span>  <span class="mf">0.279988</span>   <span class="o">|</span>  <span class="mf">0.301034</span>   <span class="o">|</span>   <span class="mi">13</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">2</span> <span class="o">|</span>  <span class="o">-</span><span class="mi">985</span> <span class="o">|</span>           <span class="mi">2</span> <span class="o">|</span>           <span class="mi">0</span> <span class="o">|</span> <span class="o">-</span><span class="mf">0.0614938</span>   <span class="o">|</span>  <span class="mf">0.266546</span>   <span class="o">|</span>  <span class="mf">0.27135</span>    <span class="o">|</span>   <span class="mi">16</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">3</span> <span class="o">|</span>  <span class="o">-</span><span class="mi">982</span> <span class="o">|</span>           <span class="mi">2</span> <span class="o">|</span>           <span class="mi">0</span> <span class="o">|</span>  <span class="mf">0.239601</span>    <span class="o">|</span>  <span class="mf">0.237615</span>   <span class="o">|</span>  <span class="mf">0.223317</span>   <span class="o">|</span>   <span class="mi">19</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">4</span> <span class="o">|</span>  <span class="o">-</span><span class="mi">979</span> <span class="o">|</span>           <span class="mi">2</span> <span class="o">|</span>           <span class="mi">0</span> <span class="o">|</span>  <span class="mf">0.331415</span>    <span class="o">|</span>  <span class="mf">0.208171</span>   <span class="o">|</span>  <span class="mf">0.192523</span>   <span class="o">|</span>   <span class="mi">22</span> <span class="o">|</span>
</pre></div>
</div>
<p>The columns are: time-lag, negative time-lag std, positive time-lag std,
zdcf, negative zdcf sampling error, positive zdcf sampling error, number
of points per bin. For more information on how these values are
calculated see <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1997ASSL..218..163A/abstract">Alexander 1997</a>.</p>
<p>The code will also generate an output .dcf file in a specified folder on your
computer with same 7 columns containing the results. It is allowed to
name these files however you want using the <code class="docutils literal notranslate"><span class="pre">prefix</span></code> parameter (see
example in the next subsection).</p>
<p>Optionally, by adding keyword argument <code class="docutils literal notranslate"><span class="pre">savelc</span> <span class="pre">=</span> <span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">pyzdcf</span></code> can
create and save light curve files used as input after averaging points
with identical times.</p>
<p><strong>Running the code</strong></p>
<p>An example for calculating cross-correlation between two light curves:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyzdcf</span> <span class="kn">import</span> <span class="n">pyzdcf</span>

<span class="nb">input</span> <span class="o">=</span> <span class="s1">&#39;./input/&#39;</span>           <span class="c1"># Path to the input data</span>
<span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;./output/&#39;</span>         <span class="c1"># Path to the directory for saving the results</span>

<span class="c1"># Light curve names</span>
<span class="n">lc1</span> <span class="o">=</span> <span class="s1">&#39;lc_name1&#39;</span>
<span class="n">lc2</span> <span class="o">=</span> <span class="s1">&#39;lc_name2&#39;</span>

<span class="c1"># Parameters are passed to the pyZDCF as a dictionary</span>

<span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">autocf</span>            <span class="o">=</span>  <span class="kc">False</span><span class="p">,</span> <span class="c1"># Autocorrelation (T) or cross-correlation (F)</span>
              <span class="n">prefix</span>            <span class="o">=</span> <span class="s1">&#39;ccf&#39;</span><span class="p">,</span>  <span class="c1"># Output files prefix</span>
              <span class="n">uniform_sampling</span>  <span class="o">=</span>  <span class="kc">False</span><span class="p">,</span> <span class="c1"># Uniform sampling?</span>
              <span class="n">omit_zero_lags</span>    <span class="o">=</span>  <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Omit zero lag points?</span>
              <span class="n">minpts</span>            <span class="o">=</span>  <span class="mi">0</span><span class="p">,</span>     <span class="c1"># Min. num. of points per bin (0 is a flag for default value of 11)</span>
              <span class="n">num_MC</span>            <span class="o">=</span>  <span class="mi">100</span><span class="p">,</span>   <span class="c1"># Num. of Monte Carlo simulations for error estimation</span>
              <span class="n">lc1_name</span>          <span class="o">=</span>  <span class="n">lc1</span><span class="p">,</span>   <span class="c1"># Name of the first light curve file</span>
              <span class="n">lc2_name</span>          <span class="o">=</span>  <span class="n">lc2</span>    <span class="c1"># Name of the second light curve file (required only if we do CCF)</span>
             <span class="p">)</span>

<span class="c1"># Here we use non-interactive mode (intr=False)</span>
<span class="n">dcf_df</span> <span class="o">=</span> <span class="n">pyzdcf</span><span class="p">(</span><span class="n">input_dir</span>  <span class="o">=</span> <span class="nb">input</span><span class="p">,</span>
                <span class="n">output_dir</span> <span class="o">=</span> <span class="n">output</span><span class="p">,</span>
                <span class="n">intr</span>       <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">parameters</span> <span class="o">=</span> <span class="n">params</span><span class="p">,</span>
                <span class="n">sep</span>        <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span>
                <span class="n">sparse</span>     <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                <span class="n">verbose</span>    <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># To run the program in interactive mode (like the original Fortran code):</span>
<span class="n">dcf_df</span> <span class="o">=</span> <span class="n">pyzdcf</span><span class="p">(</span><span class="n">input_dir</span>  <span class="o">=</span> <span class="nb">input</span><span class="p">,</span>
                <span class="n">output_dir</span> <span class="o">=</span> <span class="n">output</span><span class="p">,</span>
                <span class="n">intr</span>       <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                <span class="n">sep</span>        <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span>
                <span class="n">sparse</span>     <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                <span class="n">verbose</span>    <span class="o">=</span> <span class="kc">True</span>
                <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>For more examples see <a class="reference external" href="https://github.com/LSST-sersag/pyzdcf/blob/main/notebooks/examples.ipynb">example
notebook</a>.</p></li>
<li><p>Additionally, you can also check out code description of the original
Fortran version because the majority of input parameters and all
output files are the same as in pyZDCF. You can download the fortran
source code
<a class="reference external" href="https://www.weizmann.ac.il/particle/tal/research-activities/software">here</a>.</p></li>
</ul>
</section>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Added an option to use <strong>sparse matrix implementation</strong> for reduced
RAM usage when working with long light curves (&gt;3000 points). The main benefit is that we can now run these demanding calculations on our own personal computers (8 GB of RAM is enough for light curves containing up to 15000 points), making the usage of this algorithm more convinient than ever. You can turn this on/off by specifying <code class="docutils literal notranslate"><span class="pre">sparse</span></code> keyword argument to <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>. Default value is <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>, where sparse marices are utilized when there are more than 3000 points per light curve. Note that by reducing RAM usage, we pay in increased program running time.</p></li>
<li><p><strong>Interactive mode</strong>: program specifically asks the user to provide
necessary parameters (similar to original Fortran version);</p></li>
<li><p><strong>Manual mode</strong>: user can provide all parameters in one dictionary.</p></li>
</ul>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline"></a></h2>
<p>Distributed under the MIT License.</p>
</section>
<section id="contact">
<h2>Contact<a class="headerlink" href="#contact" title="Permalink to this headline"></a></h2>
<blockquote>
<div><div class="line-block">
<div class="line"><strong>Isidora Jankov (main)</strong> - <a class="reference external" href="mailto:isidora_jankov&#37;&#52;&#48;matf&#46;bg&#46;ac&#46;rs">isidora_jankov<span>&#64;</span>matf<span>&#46;</span>bg<span>&#46;</span>ac<span>&#46;</span>rs</a></div>
<div class="line">Andjelka Kovačević - <a class="reference external" href="mailto:andjelka&#37;&#52;&#48;matf&#46;bg&#46;ac&#46;rs">andjelka<span>&#64;</span>matf<span>&#46;</span>bg<span>&#46;</span>ac<span>&#46;</span>rs</a></div>
<div class="line">Dragana Ilić - <a class="reference external" href="mailto:dilic&#37;&#52;&#48;matf&#46;bg&#46;ac&#46;rs">dilic<span>&#64;</span>matf<span>&#46;</span>bg<span>&#46;</span>ac<span>&#46;</span>rs</a></div>
</div>
</div></blockquote>
<dl class="simple">
<dt>You can write to us:</dt><dd><ul class="simple">
<li><p>if there are any problems running the code on your system;</p></li>
<li><p>to give suggestions for code improvements.</p></li>
</ul>
</dd>
</dl>
<p>If you want to report a bug, please open an Issue on GitHub.</p>
<p>Project Link: <a class="reference external" href="https://github.com/LSST-sersag/pyzdcf">https://github.com/LSST-sersag/pyzdcf</a></p>
</section>
<section id="citation">
<h2>Citation<a class="headerlink" href="#citation" title="Permalink to this headline"></a></h2>
<p>Coming soon!</p>
</section>
<section id="api-documentation">
<h2>API documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyzdcf.pyzdcf">
<span class="sig-prename descclassname"><span class="pre">pyzdcf.</span></span><span class="sig-name descname"><span class="pre">pyzdcf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savelc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'autocf':</span> <span class="pre">False,</span> <span class="pre">'lc1_name':</span> <span class="pre">'lc1_example',</span> <span class="pre">'lc2_name':</span> <span class="pre">'lc2_example',</span> <span class="pre">'minpts':</span> <span class="pre">0,</span> <span class="pre">'num_MC':</span> <span class="pre">100,</span> <span class="pre">'omit_zero_lags':</span> <span class="pre">True,</span> <span class="pre">'prefix':</span> <span class="pre">'ccf',</span> <span class="pre">'uniform_sampling':</span> <span class="pre">False}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyzdcf.pyzdcf" title="Permalink to this definition"></a></dt>
<dd><p>Calculates auto-correlation or cross-correlation function of user-provided
light curve(s) using the ZDCF (Z-transformed Discrete Correlation Function)
method (Alexander, 1997).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dir</strong> (<em>str</em>) – Path to the directory containing input light curve(s).</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Path to the directory for storing the results.</p></li>
<li><p><strong>intr</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use interactive user input. Otherwise, use a
dictionary with input parameters in the ‘parameters’ keyword argument.
Defaults to True.</p></li>
<li><p><strong>sep</strong> (<em>str</em><em>, </em><em>optional</em>) – Delimiter to use when reading the file(s). Defaults to ‘,’.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Print additional information while running the calculations.
Defaults to True.</p></li>
<li><p><strong>sparse</strong> (<em>{'auto'</em><em>, </em><em>True</em><em>, </em><em>False}</em><em>, </em><em>optional</em>) – If True, use sparse matrices when allocating work areas in
order to save memory. If False, use classical numpy arrays (not
recommended for light curves containing &gt; 3000 points when running
pyZDCF on a 8 GB RAM personal computer). Default value is ‘auto’ and it
forces the program to use sparse matrices with light curves of 3000 or
more points.</p></li>
<li><p><strong>savelc</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, save the condensed light curve, otherwise skip this
step. Defaults to False.</p></li>
<li><p><strong>parameters</strong> (<em>dict</em><em>, </em><em>optional</em>) – A dictionary containing all the required parameters (keys are parameter
names). Defaults to a dictionary with placeholder values, it is up to the
user to provide correct values for given keys (input parameters).
Required parameters key names (types) are: <cite>autocf</cite> (bool), <cite>prefix</cite> (str),
<cite>uniform_sampling</cite> (bool), <cite>omit_zero_lags</cite> (bool), <cite>minpts</cite> (str/int),
<cite>num_MC</cite> (str/int), <cite>lc1_name</cite> (str). The key <cite>lc2_name</cite> needs to be provided
only if you choose to perform cross-correlation (by setting <cite>autocf</cite> to <cite>False</cite>).
The <cite>params</cite> argument is used only in manual mode (<cite>intr</cite> argument set to <cite>False</cite>).
For description of all input parameters, consult the “How to use” section in the docs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dcf_df</strong> – A pandas DataFrame organized in 7 columns displaying the results for
each time-lag bin. The columns are: time-lag, negative time-lag std,
positive time-lag std, zdcf, negative zdcf sampling error, positive
zdcf sampling error, number of points per bin.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="acknowledgments">
<h2>Acknowledgments<a class="headerlink" href="#acknowledgments" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>The pyZDCF module is based on the original Fortran code developed by
Prof. Tal Alexander (Weizmann Institute of Science, Israel). You can download original Fortran version from professor’s
<a class="reference external" href="https://www.weizmann.ac.il/particle/tal/research-activities/software">page</a>.</p></li>
<li><p>For theoretical details regarding the ZDCF algorithm see this publication: <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1997ASSL..218..163A/abstract">Alexander 1997</a>.</p></li>
<li><p>Huge thanks to my closest collegues and mentors Dr. Andjelka
Kovačević and Dr. Dragana Ilić, as well as to Dr. Paula Sánchez-Sáez
and Dr. Robert Nikutta for invaluable input during the development
and testing of this python module.</p></li>
<li><p>Many thanks to Prof. Eli Waxman, Amir Bar On and former students of
Prof. Tal Alexander for their kind assistance regarding the
development of pyZDCF module and for its acknowledgment as part of the
legacy behind late Prof. Alexander.</p></li>
</ul>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1997ASSL..218..163A/abstract">Alexander, T. 1997, in: Astronomical Time Series, eds. D. Maoz, A.
Sternberg, &amp; E. M. Leibowitz, Vol. 218, Springer, Is AGN Variability
Correlated with Other AGN Properties? ZDCF Analysis of Small Samples
of Sparse Light
Curves</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2022AN....34310090J/abstract">Jankov, I.; Kovačević A. B.; Ilić, D.; et al. 2022, Astronomische
Nachrichten, 343,
e210090</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2014AdSpR..54.1414K/abstract">Kovačević, A.; Popović, L. Č.; Shapovalova, A. I.; et al. 2014,
Advances in Space Research, 54,
1414-1428</a></p></li>
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019MNRAS.485.4790S/abstract">Shapovalova, A. I.; Popović, L. Č.; Afanasiev, V. L.; et al. 2019,
MNRAS, 485,
4790-4803</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Isidora Jankov, Andjelka Kovacevic, Dragana Ilic, Paula Sanchez-Saez and Robert Nikutta.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>